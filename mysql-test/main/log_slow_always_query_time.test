--source include/have_debug.inc
--source include/not_valgrind.inc

#
# Test log_slow_always_query_time variable usage
#

# Force deterministic session and query ids
--source include/restart_mysqld.inc
--source include/log_slow_prepare.inc

--let $log_slow_prefix=log_slow_always_query_time
--let $log_file=$log_slow_prefix-1

select @@session.log_slow_always_query_time;
SET GLOBAL log_slow_always_query_time= 20.2;
SET SESSION log_slow_always_query_time=20.2;
select @@global.log_slow_always_query_time, @@session.log_slow_always_query_time;
set GLOBAL log_slow_always_query_time= default;

SET log_slow_query_time=5.0;
SET log_slow_rate_limit=999;
SET log_slow_always_query_time=10.0;
SET log_slow_min_examined_row_limit= 100;

--source include/log_slow_start.inc
SELECT sleep(11) as 'this-should-be-logged';
SELECT sleep(6) as 'this-should-not-be-logged';

--let grep_pattern=this-should
--let $log_expected_matches=1
--source include/log_grep.inc

--source include/log_slow_cleanup.inc
